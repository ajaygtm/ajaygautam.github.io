---
import Layout from '~/layouts/PageLayout.astro';
import {fetchProjects} from '~/utils/projects.js';
import MarkdownIt from 'markdown-it';

export async function getStaticPaths() {
  const projects = await fetchProjects();
  return projects.map(p => ({
    params: { slug: p.slug },
    props: { project: p }
  }));
}

const {project} = Astro.props;

const md = new MarkdownIt({ linkify: true });
const html = md.render(project.body || '');

const meta = {
  title: `${project.title} â€” Your Name`,
  description: project.summary
};
---

<Layout {meta}>
  <article class="max-w-3xl mx-auto px-4 py-12">
    <header class="mb-8">
      <h1 class="text-4xl font-bold mb-3">{project.title}</h1>
      <p class="text-gray-600 dark:text-gray-400">{project.summary}</p>
      {project.impact && (
        <p class="mt-2 text-sm text-primary-600 dark:text-primary-400 font-medium">
          Impact: {project.impact}
        </p>
      )}
      {project.repo && (
        <p class="mt-2 text-sm">
          <a class="underline hover:text-primary-600" href={project.repo} target="_blank" rel="noopener">
            Source code
          </a>
        </p>
      )}
    </header>
    <div class="prose dark:prose-invert max-w-none" set:html={html} />
  </article>
</Layout>